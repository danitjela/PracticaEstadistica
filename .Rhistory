correlacion_df <- data.frame(Variable1 = "copiesSold",
Variable2 = "revenue",
Correlacion = round(correlacion, 2))
correlacion_df %>%
kable(caption = "Correlación entre las copias vendidas y la recaudación") %>%
kable_styling(full_width = F)
umbral_copiesSold <- 10e6
umbral_revenue <- 200e6
lab_filt <- lab %>%
filter(copiesSold <= umbral_copiesSold & revenue <= umbral_revenue)
modelo <- lm(revenue ~ copiesSold, data = lab_filt)
summary(modelo)
ggplot(lab_filt, aes(x = copiesSold, y = revenue)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", color = "blue") +
scale_x_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
scale_y_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
labs(title = "Regresión Lineal: Copias Vendidas vs Recaudación",
x = "Copias Vendidas",
y = "Recaudación (en miles de dólares)") +
theme_minimal()
price_filtrado_breaks <- seq(min(lab_filtrado$price), max(lab_filtrado$price), length.out = 8)
lab_filtrado$price_intervalos <- cut(lab_filtrado$price, breaks = price_filtrado_breaks, include.lowest = TRUE)
revenue_breaks <- c(20000, 5000000, 50000000, 85000000, 150000000, 250000000, 335000000, 500000000, 585000000, 650000000, 755000000, 850000000)
revenue_labels <- c("[20k-5M]", "(5M-50M]", "(50M-85M]", "[85M-150M]", "(150M-250M]", "(250M-335M]", "(335M-500M]", "(500M-585M]", "(585M-650M]", "(650M-755M]", "(755M-850M]")
lab_filtrado$revenue_intervalos <- cut(lab_filtrado$revenue, breaks = revenue_breaks, labels = revenue_labels, include.lowest = TRUE)
tabla_abs_priceRevenue <- table(lab_filtrado$revenue_intervalos, lab_filtrado$price_intervalos)
tabla_rel_priceRevenue <- prop.table(tabla_abs_priceRevenue) * 100
tabla_contingencia_priceRevenue <- matrix(paste(tabla_abs_priceRevenue, "(", round(tabla_rel_priceRevenue, 2), "%)", sep = ""),
nrow = nrow(tabla_abs_priceRevenue), ncol = ncol(tabla_abs_priceRevenue))
rownames(tabla_contingencia_priceRevenue) <- rownames(tabla_abs_priceRevenue)
colnames(tabla_contingencia_priceRevenue) <- colnames(tabla_abs_priceRevenue)
kable(tabla_contingencia_priceRevenue, caption = htmltools::tags$div(style = "text-align: center;",
htmltools::tags$h4(htmltools::tags$strong("y: beneficios(dólares) // x: precio(dólares)")))) |>
kable_styling(latex_options = c("striped", "hold_position"))
lab_filtrado2 <- lab_filtrado[lab_filtrado$revenue <= 5000000,]
revenue_filtrado2 <- lab_filtrado2$revenue_intervalos
revenue_breaks2 <- c(20000, 50000, 100000, 250000 ,500000, 1000000, 5000000)
revenue_labels2 <- c("[20k-50k]", "(50k-100k]", "(100k-250k]", "(250k-500k]", "(500k-1M]", "(1M-5M]")
lab_filtrado2$revenue_intervalos <- cut(lab_filtrado2$revenue, breaks = revenue_breaks2, labels = revenue_labels2, include.lowest = TRUE)
tabla_abs_priceRevenue2 <- table(lab_filtrado2$revenue_intervalos, lab_filtrado2$price_intervalos)
tabla_rel_priceRevenue2 <- prop.table(tabla_abs_priceRevenue2) * 100
tabla_contingencia_priceRevenue2 <- matrix(paste(tabla_abs_priceRevenue2, "(", round(tabla_rel_priceRevenue2, 2), "%)", sep = ""),
nrow = nrow(tabla_abs_priceRevenue2), ncol = ncol(tabla_abs_priceRevenue2))
rownames(tabla_contingencia_priceRevenue2) <- rownames(tabla_abs_priceRevenue2)
colnames(tabla_contingencia_priceRevenue2) <- colnames(tabla_abs_priceRevenue2)
kable(tabla_contingencia_priceRevenue2, caption = htmltools::tags$div(style = "text-align: center;",
htmltools::tags$h4(htmltools::tags$strong("y: beneficios(dólares) // x: precio(dólares)")))) |>
kable_styling(latex_options = c("striped", "hold_position"))
lab_filtrado |>
ggplot(aes(x = revenue, y = price)) +
geom_point() +
geom_smooth() +
labs(title = "Gráfico de dispersión con ajuste de regresión automático:") +
scale_x_continuous(breaks = c(0, 200000000, 400000000, 600000000, 800000000), labels = c("0", "200M", "400M", "600M", "800M")) +
theme_bw()
lab_filtrado2 |>
ggplot(aes(x = revenue, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
labs(title = "Gráfico de dispersión con ajuste de regresión lineal:")+
scale_x_continuous(breaks = c(0, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("0", "1M", "2M", "3M", "4M", "5M"))+
theme_bw()
summary(lab_filtrado2 |> select(revenue, price) |> with(lm(revenue ~ price)))
cor(lab_filtrado2$price, lab_filtrado2$revenue)
summary(lab_filtrado2 |> select(revenue, price) |> with(lm(revenue ~ price))) |>
vcov()
correlacion <- cor(lab$avgPlaytime, lab$revenue, use = "complete.obs")
correlacion_df <- data.frame(Variable1 = "avgPlaytime",
Variable2 = "revenue",
Correlacion = round(correlacion, 2))
correlacion_df %>%
kable(caption = "Correlación entre el tiempo de juego medio y la recaudación") %>%
kable_styling(full_width = F)
ggplot(lab, aes(x = revenue, y = avgPlaytime)) +
geom_jitter(color = "blue", size = 1, width = 0.2, height = 0, alpha = 0.7) +
scale_y_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
scale_x_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
labs(title = "Relación entre las horas de juego y Recaudación",
x = "Recaudación",
y = "HOras de juego") +
theme_minimal()
ggplot(data = labNo0, aes(x = reviewScore, y = revenue)) +
geom_point(alpha = 0.5) +
labs(title = "Relación entre Puntuación y Recaudación",
x = "Puntuación",
y = "Recaudación") +
theme_minimal()  # Usar un tema minimalista
modelo <- lm(revenue ~ reviewScore, data = labNo0)
summary(modelo)
ggplot(data = labNo0, aes(x = reviewScore, y = revenue)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", color = "blue") +
labs(title = "Relación entre Puntuación y Recaudación con Línea de Regresión",
x = "Puntuación",
y = "Recaudación") +
theme_minimal()
ggplot(lab, aes(x = publisherClass, y = revenue)) +
geom_bar(stat = "summary", fun = "mean", fill = "steelblue") +  # Barras que muestran la media
labs(title = "Recaudación por tipo de empresa",
x = "Tipo de empresa",
y = "Recaudación promedio") +
theme_minimal()
ggplot(lab, aes(x = publisherClass, y = revenue)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
labs(title = "Distribución de la Recaudación por Tipo de Empresa",
x = "Tipo de Empresa",
y = "Recaudación") +
theme_minimal()
ggplot(lab, aes(x = publisherClass, y = revenue)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
scale_y_log10() +
labs(title = "Distribución de la Recaudación por Tipo de Empresa (Escala Logarítmica)",
x = "Tipo de Empresa",
y = "Recaudación (log)") +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE,
eval = TRUE,
warning = FALSE,
message = FALSE,
error = TRUE)
library(tidyverse)
library(summarytools)
library(GGally)
library(gt)
library(flextable)
library(knitr)
library(corrplot)
library(dplyr)
library(kableExtra)
lab <- read.csv("DATA/Steam_2024_bestRevenue_1500.csv", header = TRUE, sep = ",")
lab |>
mutate(releaseDate = as.Date(releaseDate))
lab |>
slice_head(n=10) |>
gt()
lab <- lab |>
mutate(releaseDate = as.Date(releaseDate, format = "%d-%m-%Y"))
lab <- lab |>
mutate(mes = format(releaseDate, "%m"),
mes = factor(mes, levels = sprintf("%02d", 1:12), labels = month.abb))
lanzamientos_mes <- lab |>
group_by(mes) |>
summarise(n_juegos = n(), .groups = 'drop')
ggplot(lanzamientos_mes, aes(x = mes, y = n_juegos, fill = n_juegos)) +
geom_bar(stat = "identity", color = "white", alpha = 0.8) +
scale_fill_gradient2(low = "steelblue", mid = "skyblue", high = "red", midpoint = median(lanzamientos_mes$n_juegos)) +
theme_bw() +
labs(title = "Distribución de las fechas de lanzamiento del 2024",
x = "Mes",
y = "Nº Lanzamientos")
copiesSold_breaks <- c(500, 5000, 10000, 15000, 25000, 50000, 100000, 1000000, 5000000, 10000000, 31000000)
copiesSold_labels <- c("[500-5k]", "(5k-10k]", "(10k-15k]", "(15k-25k]", "(25k-50k]", "(50k-100k]", "(100k-1M]", "(1M-5M]", "(5M-10M]", "(10M-31M]")
lab$copiesSold_intervalos <- cut(lab$copiesSold, breaks = copiesSold_breaks, labels = copiesSold_labels, include.lowest = TRUE)
table(lab$copiesSold_intervalos) |>
as.data.frame() |>
mutate(freqRelativa = Freq / sum(Freq), freqAbsAcumulada = cumsum(Freq), freqRelAcumulada = cumsum(freqRelativa)) |>
gt() |>
tab_header(
title = md("**_Nº de copias vendidas_**")
) |>
cols_label(Var1 = "\\(x_i\\)", Freq = "\\(n_i\\)", freqRelativa = "\\(f_i\\)",
freqAbsAcumulada = "\\(N_i\\)", freqRelAcumulada = "\\(F_i\\)") |>
fmt_number(3, decimals = 4) |>
tab_style(style = list (cell_text(weight = "bold")), locations = cells_column_labels()) |>
tab_style(style = list(cell_text(weight = "bold")),  locations = cells_body(rows = c(1, 2)))
ggplot(data.frame(x = lab$copiesSold), aes(x = x)) +
geom_histogram(binwidth = 200000, fill = "steelblue", color = "white",
aes(y = ..count..)) +
theme_bw() +
labs(title = "Distribución del Nº de copias vendidas:",
x = "Precio ($)",
y = expression("Frecuencia absoluta ("*n[i]*")")) +
scale_x_continuous(limits = c(500, 6000000),
breaks = seq(1000000, 6000000, by = 1000000),
labels = c("1M", "2M", "3M", "4M", "5M", "6M")) +
scale_y_continuous(limits = c(0, 130),
breaks = seq(0, 130, by = 20),
labels = seq(0, 130, by = 20))
ggplot(lab, aes(x = copiesSold)) +
geom_histogram(binwidth = 200000, fill = "steelblue", color = "white",
aes(y = ..count../sum(..count..))) +
stat_function(fun = dnorm, args = list(mean = mean(lab$copiesSold),
sd = sd(lab$copiesSold)), color = "red", size = 1.5, alpha = 0.6) +
theme_bw() +
labs(title = "Distribución del Nº de copias vendidas:",
x = "Precio ($)",
y = expression("Frecuencia relativa ("*f[i]*")")) +
scale_x_continuous(limits = c(0, 6000000),
breaks = seq(1000000, 6000000, by = 1000000),
labels = c("1M", "2M", "3M", "4M", "5M", "6M")) +
scale_y_continuous(limits = c(0, 0.025),
breaks = seq(0, 0.025, by = 0.01),
labels = seq(0, 0.025, by = 0.01))
lab|> select(copiesSold) |> descr() |> kable(digits = 2)
price_breaks <- seq(min(lab$price), max(lab$price), length.out = 11)
lab$price_intervalos <- cut(lab$price, breaks = price_breaks, include.lowest = TRUE)
table(lab$price_intervalos) |>
as.data.frame() |>
mutate(freqRelativa = Freq / sum(Freq), freqAbsAcumulada = cumsum(Freq), freqRelAcumulada = cumsum(freqRelativa)) |>
gt() |>
tab_header(
title = md("**_Precio por copia ($)_**")
) |>
cols_label(Var1 = "\\(x_i\\)", Freq = "\\(n_i\\)", freqRelativa = "\\(f_i\\)",
freqAbsAcumulada = "\\(N_i\\)", freqRelAcumulada = "\\(F_i\\)") |>
fmt_number(3, decimals = 4) |>
tab_style(style = list (cell_text(weight = "bold")), locations = cells_column_labels())
lab_filtrado <- lab[lab$price != 99.99,]
price_filtrado <- lab_filtrado$price
ggplot(data.frame(x = price_filtrado), aes(x = x)) +
geom_histogram(binwidth = 3, fill = "steelblue", color = "white",
aes(y = ..count..)) +
theme_bw() +
labs(title = "Distribución del precio por copia:",
x = "Precio ($)",
y = expression("Frecuencia absoluta ("*n[i]*")"))
ggplot(data.frame(x = price_filtrado), aes(x = x)) +
geom_histogram(binwidth = 5, fill = "steelblue", color = "white",
aes(y = ..count../sum(..count..))) +
stat_function(fun = dnorm, args = list(mean = mean(price_filtrado),
sd = sd(price_filtrado)), color = "red", size = 1.5, alpha = 0.6) +
theme_bw() +
labs(title = "Distribución del precio por copia:",
x = "Precio ($)",
y = expression("Frecuencia relativa ("*f[i]*")"))
analisis_price <- lab|> select(price) |> descr() |> kable(digits = 2)
analisis_price_filtrado <- price_filtrado |> descr() |> kable(digits = 2)
cbind(analisis_price, analisis_price_filtrado) |>
kable(digits = 2)
ggplot(lab, aes(x = revenue)) +
geom_histogram(binwidth = 2000000, fill = "steelblue", color = "white") +
labs(title = "Distribución de los Beneficios de los Videojuegos",
x = "Beneficios ($)",
y = "Frecuencia") +
ylim(0, 200) +  # Establece el rango del eje Y de 0 a 500
xlim(0, 50000000) +  # Limita el rango del eje X a 50 millones
theme_minimal() +
scale_x_continuous(limits = c(0, 50000000),
breaks = seq(10000000, 50000000, by = 10000000),
labels = c("10M", "20M", "30M", "40M", "50M"))
lab |> ggplot(aes(avgPlaytime)) +
geom_histogram(
fill = "steelblue",
col = "white",
breaks = seq(0,100, by = 10)
) +
theme_bw() +
labs(x = "Tiempo promedio de juego (horas)", y = "Frecuencia", title = "Distribución de tiempo de juego por intervalos")
top_ten_games <- lab %>%
arrange(desc(avgPlaytime)) %>%
slice(1:10) %>%
select(name, avgPlaytime) %>%
mutate(avgPlaytime = round(avgPlaytime, 2))
top_ten_games |>
kable(caption = "Los 10 juegos con más horas de juego") |>
kable_styling(full_width = F)
num_respuestas_SCORE <- length(unique(lab$reviewScore))
cat("La cantidad de respuestas obtenidas es:", num_respuestas_SCORE)
max_val <- max(lab$reviewScore)
max_val <- min(max_val, 100)
lab$reviewScore_rango <- cut(lab$reviewScore,
breaks = c(0, 1, seq(5, max_val, by = 5)),
right = FALSE,
include.lowest = TRUE,
labels = c("0", paste(seq(1, max_val-4, by = 5), seq(5, max_val, by = 5)-1, sep = "-")))
tabla_frecuencias_score <- lab |>
count(reviewScore_rango) |>
mutate(f = n / nrow(lab), N = cumsum(n), F = cumsum(f))
tabla_frecuencias_ordenada4 <- tabla_frecuencias_score |>
arrange(desc(n))
tabla_frecuencias_ordenada4$F <- cumsum(tabla_frecuencias_ordenada4$f)
tabla_frecuencias_ordenada4$N <- cumsum(tabla_frecuencias_ordenada4$n)
print(tabla_frecuencias_ordenada4)
labNo0 <- subset(lab, reviewScore != 0)
datos <- labNo0$reviewScore
ggplot(data.frame(x = datos), aes(x = x)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "white",
aes(y = ..density..), alpha = 0.6) +
stat_function(fun = dnorm, args = list(mean = mean(datos),
sd = sd(datos)), color = "red", size = 1.5) +
labs(title = "Distribución de las puntuaciones",
x = "Puntuación",
y = "Frecuencia") +
theme_minimal()
labNo0 |> select(reviewScore) |> descr() |> kable(digits = 2)
tabla_frecuencias_publisherclass <- lab |>
count(publisherClass) |>
mutate(f = n / nrow(lab))
print(tabla_frecuencias_publisherclass)
lab  |> group_by(publisherClass) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), publisherClass = reorder(publisherClass, -Frequency)) |> ggplot(aes(x = publisherClass, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de PUBLISHERCLASS", x = "Tipo de empresa", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "steelblue", high = "#CB0017") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
top_publishers <- lab %>%
count(publishers) %>%
top_n(10, n)
ggplot(top_publishers, aes(x = reorder(publishers, n), y = n)) +
geom_bar(stat = "identity", fill = "steelblue", color = "white") +
labs(title = "Top 10 Publishers por Número de Videojuegos",
x = "Publisher",
y = "Número de Videojuegos") +
theme_minimal() +
coord_flip()
table(lab$developers) |>
as.data.frame() |>
arrange(desc(Freq)) |>
slice(1:10) |>
mutate(F = cumsum(Freq)/sum(Freq)) |>
gt() |>
tab_header(
title = md("**_Los 10 desarrolladores más frecuentes_**")
) |>
cols_label(Var1 = "Desarrollador",
Freq = "Frecuencia",
F = "Frecuencia relativa acumulada") |>
fmt_number(3, decimals = 4) |>
tab_style(style = list(
cell_text(weight = "bold")),
locations = cells_column_labels())
labNo0 |> select(copiesSold, revenue, price, reviewScore, avgPlaytime) |>
cor() |>
corrplot(method = "ellipse",  # Usa elipses para representar correlaciones
type = "lower",  # Muestra solo la mitad inferior de la matriz
addCoef.col = "steelblue",  # Color de los coeficientes de correlación
diag = FALSE)  # Omite la diagonal principal
sum(is.na(lab$copiesSold))
sum(is.na(lab$revenue))
summary(lab$copiesSold)
summary(lab$revenue)
ggplot(lab, aes(x = copiesSold, y = revenue)) +
geom_jitter(color = "blue", size = 1, width = 0.2, height = 0, alpha = 0.7) +
scale_y_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
scale_x_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
labs(title = "Relación entre Copias Vendidas y Recaudación",
x = "Copias Vendidas",
y = "Recaudación (en logaritmos)") +
theme_minimal()
correlacion <- cor(lab$copiesSold, lab$revenue, use = "complete.obs")
correlacion_df <- data.frame(Variable1 = "copiesSold",
Variable2 = "revenue",
Correlacion = round(correlacion, 2))
correlacion_df %>%
kable(caption = "Correlación entre las copias vendidas y la recaudación") %>%
kable_styling(full_width = F)
umbral_copiesSold <- 10e6
umbral_revenue <- 200e6
lab_filt <- lab %>%
filter(copiesSold <= umbral_copiesSold & revenue <= umbral_revenue)
modelo <- lm(revenue ~ copiesSold, data = lab_filt)
summary(modelo)
ggplot(lab_filt, aes(x = copiesSold, y = revenue)) +
geom_point(size = 2, alpha = 0.7) +
geom_smooth(method = "lm", color = "blue") +
scale_x_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
scale_y_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
labs(title = "Regresión Lineal: Copias Vendidas vs Recaudación",
x = "Copias Vendidas",
y = "Recaudación (en miles de dólares)") +
theme_minimal()
price_filtrado_breaks <- seq(min(lab_filtrado$price), max(lab_filtrado$price), length.out = 8)
lab_filtrado$price_intervalos <- cut(lab_filtrado$price, breaks = price_filtrado_breaks, include.lowest = TRUE)
revenue_breaks <- c(20000, 5000000, 50000000, 85000000, 150000000, 250000000, 335000000, 500000000, 585000000, 650000000, 755000000, 850000000)
revenue_labels <- c("[20k-5M]", "(5M-50M]", "(50M-85M]", "[85M-150M]", "(150M-250M]", "(250M-335M]", "(335M-500M]", "(500M-585M]", "(585M-650M]", "(650M-755M]", "(755M-850M]")
lab_filtrado$revenue_intervalos <- cut(lab_filtrado$revenue, breaks = revenue_breaks, labels = revenue_labels, include.lowest = TRUE)
tabla_abs_priceRevenue <- table(lab_filtrado$revenue_intervalos, lab_filtrado$price_intervalos)
tabla_rel_priceRevenue <- prop.table(tabla_abs_priceRevenue) * 100
tabla_contingencia_priceRevenue <- matrix(paste(tabla_abs_priceRevenue, "(", round(tabla_rel_priceRevenue, 2), "%)", sep = ""),
nrow = nrow(tabla_abs_priceRevenue), ncol = ncol(tabla_abs_priceRevenue))
rownames(tabla_contingencia_priceRevenue) <- rownames(tabla_abs_priceRevenue)
colnames(tabla_contingencia_priceRevenue) <- colnames(tabla_abs_priceRevenue)
kable(tabla_contingencia_priceRevenue, caption = htmltools::tags$div(style = "text-align: center;",
htmltools::tags$h4(htmltools::tags$strong("y: beneficios(dólares) // x: precio(dólares)")))) |>
kable_styling(latex_options = c("striped", "hold_position"))
lab_filtrado2 <- lab_filtrado[lab_filtrado$revenue <= 5000000,]
revenue_filtrado2 <- lab_filtrado2$revenue_intervalos
revenue_breaks2 <- c(20000, 50000, 100000, 250000 ,500000, 1000000, 5000000)
revenue_labels2 <- c("[20k-50k]", "(50k-100k]", "(100k-250k]", "(250k-500k]", "(500k-1M]", "(1M-5M]")
lab_filtrado2$revenue_intervalos <- cut(lab_filtrado2$revenue, breaks = revenue_breaks2, labels = revenue_labels2, include.lowest = TRUE)
tabla_abs_priceRevenue2 <- table(lab_filtrado2$revenue_intervalos, lab_filtrado2$price_intervalos)
tabla_rel_priceRevenue2 <- prop.table(tabla_abs_priceRevenue2) * 100
tabla_contingencia_priceRevenue2 <- matrix(paste(tabla_abs_priceRevenue2, "(", round(tabla_rel_priceRevenue2, 2), "%)", sep = ""),
nrow = nrow(tabla_abs_priceRevenue2), ncol = ncol(tabla_abs_priceRevenue2))
rownames(tabla_contingencia_priceRevenue2) <- rownames(tabla_abs_priceRevenue2)
colnames(tabla_contingencia_priceRevenue2) <- colnames(tabla_abs_priceRevenue2)
kable(tabla_contingencia_priceRevenue2, caption = htmltools::tags$div(style = "text-align: center;",
htmltools::tags$h4(htmltools::tags$strong("y: beneficios(dólares) // x: precio(dólares)")))) |>
kable_styling(latex_options = c("striped", "hold_position"))
lab_filtrado |>
ggplot(aes(x = revenue, y = price)) +
geom_point() +
geom_smooth() +
labs(title = "Gráfico de dispersión con ajuste de regresión automático:") +
scale_x_continuous(breaks = c(0, 200000000, 400000000, 600000000, 800000000), labels = c("0", "200M", "400M", "600M", "800M")) +
theme_bw()
lab_filtrado2 |>
ggplot(aes(x = revenue, y = price)) +
geom_point() +
geom_smooth(method = lm, se = FALSE) +
labs(title = "Gráfico de dispersión con ajuste de regresión lineal:")+
scale_x_continuous(breaks = c(0, 1000000, 2000000, 3000000, 4000000, 5000000), labels = c("0", "1M", "2M", "3M", "4M", "5M"))+
theme_bw()
summary(lab_filtrado2 |> select(revenue, price) |> with(lm(revenue ~ price)))
cor(lab_filtrado2$price, lab_filtrado2$revenue)
summary(lab_filtrado2 |> select(revenue, price) |> with(lm(revenue ~ price))) |>
vcov()
correlacion <- cor(lab$avgPlaytime, lab$revenue, use = "complete.obs")
correlacion_df <- data.frame(Variable1 = "avgPlaytime",
Variable2 = "revenue",
Correlacion = round(correlacion, 2))
correlacion_df %>%
kable(caption = "Correlación entre el tiempo de juego medio y la recaudación") %>%
kable_styling(full_width = F)
ggplot(lab, aes(x = avgPlaytime, y = revenue)) +
geom_jitter(color = "blue", size = 1, width = 0.2, height = 0, alpha = 0.7) +
scale_y_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
scale_x_continuous(labels = function(x) {
ifelse(x >= 1e6,
paste0(format(x / 1e6, big.mark = ",", digits = 2), " M"),
ifelse(x >= 1e3,
paste0(format(x / 1e3, big.mark = ",", digits = 2), " K"),
format(x)))
}) +
labs(title = "Relación entre las horas de juego y Recaudación",
x = "Horas de juego",
y = "Recaudación") +
theme_minimal()
ggplot(data = labNo0, aes(x = reviewScore, y = revenue)) +
geom_point(alpha = 0.5) +
labs(title = "Relación entre Puntuación y Recaudación",
x = "Puntuación",
y = "Recaudación") +
theme_minimal()  # Usar un tema minimalista
modelo <- lm(revenue ~ reviewScore, data = labNo0)
summary(modelo)
ggplot(data = labNo0, aes(x = reviewScore, y = revenue)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm", color = "blue") +
labs(title = "Relación entre Puntuación y Recaudación con Línea de Regresión",
x = "Puntuación",
y = "Recaudación") +
theme_minimal()
ggplot(lab, aes(x = publisherClass, y = revenue)) +
geom_bar(stat = "summary", fun = "mean", fill = "steelblue") +  # Barras que muestran la media
labs(title = "Recaudación por tipo de empresa",
x = "Tipo de empresa",
y = "Recaudación promedio") +
theme_minimal()
ggplot(lab, aes(x = publisherClass, y = revenue)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
labs(title = "Distribución de la Recaudación por Tipo de Empresa",
x = "Tipo de Empresa",
y = "Recaudación") +
theme_minimal()
ggplot(lab, aes(x = publisherClass, y = revenue)) +
geom_boxplot(fill = "lightblue", color = "darkblue") +
scale_y_log10() +
labs(title = "Distribución de la Recaudación por Tipo de Empresa (Escala Logarítmica)",
x = "Tipo de Empresa",
y = "Recaudación (log)") +
theme_minimal()
